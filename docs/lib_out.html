<!DOCTYPE html>
<html id="html-tag" lang="en">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script>
   const $htmlTag = document.querySelector("#html-tag")
   const urlParams = new URL(window.location.toLocaleString()).searchParams;
   const lvar= urlParams.get('lang');
   switch(lvar) {
     case "hu":
       $htmlTag.lang = "hu"
       $htmlTag.classList.add("hungarianLang")
       break
     default:
       $htmlTag.classList.add("englishLang")
       break
   }
  </script>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="p12.css">
    <title>p2223 library: output functions</title>
  </head>
  
  <body>

    <p>
    <a href="devenv.html"><span lang="hu">Fejlesztés</span>
      <span lang="en">Development</span></a>
    |
    <a href="p2223.html">CPU</a>
    |
    <a href="computer_v2.html"><span lang="hu">Számítógép</span>
      <span lang="en">Computer</span></a>
    |
    <a href="asm.html">Assembler</a>
    |
    <a href="pmon.html">Monitor</a>
    |
    <a href="lib.html"><span lang="hu">Függvények</span>
      <span lang="en">Library</span></a>
    </p>

    <hr>

    <a href="lib_out.html"><span lang="hu">Kimenet</span>
      <span lang="en">Output</span></a>
    |
    <a href="lib_in.html"><span lang="en">Input</span>
      <span lang="hu">Bemenet</span></a>
    |
    <a href="lib_char.html"><span lang="hu">Karakter</span>
      <span lang="en">Character</span></a>
    |
    <a href="lib_str.html"><span lang="hu">Sztring</span>
      <span lang="en">String</span></a>
    |
    <a href="lib_math.html"><span lang="hu">Matematika</span>
      <span lang="en">Math</span></a>
    |
    <a href="lib_bsp.html"><span lang="hu">Kártya</span>
      <span lang="en">Board</span></a>
    |
    <a href="lib_sys.html"><span lang="hu">Rendszer</span>
      <span lang="en">System</span></a>
    |
    <a href="lib_std.html"><span lang="hu">Egyéb</span>
      <span lang="en">Standard</span></a>
    |
    <a href="lib_term.html"><span lang="hu">Terminál</span>
      <span lang="en">Terminal</span></a>

    <hr>
    

    <span lang="hu">Lang:</span> <span lang="en">Nyelv:</span>
    <a href="lib_out.html?lang=hu">HU</a>
    <a href="lib_out.html?lang=en">EN</a>

    <h1>
      <span lang="en">Output functions</span>
      <span lang="hu">Kimeneti függvények</span>
    </h1>

    
    <a name="putchar"><h3>putchar</h3></a>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 character</span>
	<span lang="hu">R0 karakter</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	-
      </li>
    </ul>
    
    <p>A bemenetként megadott karakterkód kiírása az UART periférián
    keresztül a terminálra. A függvény először megvárja az előzőleg
    kiírt karakter kiküldését.</p>


    <a name="prints"><h3>prints</h3></a>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 address of string</span>
	<span lang="hu">R0 sztring kezdőcíme</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	-
      </li>
    </ul>

    <p>Szöveg (0 végződésű karaktersorozat) kiírása a terminálra.</p>


    <a name="printsnl"><h3>printsnl</h3></a>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 address of string</span>
	<span lang="hu">R0 sztring kezdőcíme</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>Szöveg (0 végződésű karaktersorozat) kiírása a terminálra,
      ezután a függvény kiír egy soremelés karaktert.</p>

    
    <a name="printh"><h3>printh</h3></a>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 value;
	  <br>R1 nr of chars between separators (_)</span>
	<span lang="hu">R0 számérték;
	  <br>R1 az elválasztó (_) közötti karakterek száma</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>Kiírja a bemeneti 32 bites bináris egész szám értékét a
    terminálra hexadecimális számrendszerben, 8 karakteren, bevezető
    nullákkal. Az R1-ben megadott számú karakterenként egy _
    elválasztó jelet is kiír.</p>

    
    <a name="printd"><h3>printd</h3></a>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 value</span>
	<span lang="hu">R0 érték</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>A bemenetként megadott 32 bites (pozitív) bináris számot kiírja
      a terminálra tízes számrendszerben.</p>

    
    <a name="eprints"><h3>eprints</h3></a>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>Beágyazott, 0 végződésű karaktertömb kiírása a terminálra. A
    sztringnek a program kódjában közvetlenül a szubrutint meghívó
    CALL utasítás után kell lennie. A szubrutin a sztring záró nullája
    utáni címre fog visszatérni. Escape szekvenciák (formázó
    karakterek) nem használhatók. A funkciónak sem bemeneti, sem
    kimeneti paraméterei nincsenek. Helyes használatára egy példa:</p>

    <samp>
        nop

        call    eprints
        db      ”Hello World!\n”
        mvzl    r0,12
        ...
    </samp>

    <p>A CALL utasítás helyett ebben az esetben használható a CES
      utasítás is.</p>
    
    
    <a name="printf"><h3>printf</h3></a>

    <ul>
      <li><span lang="en">Input(s): R0 address of format string
	<br>R1..R12 parameter values</span>
	<span lang="hu">Bemenet(ek): R0 formázó szöveg címe
	<br>R1..R12 paraméterek értékei</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
    </ul>

    <p>Formázott szöveg kiírása a terminálra. A szövegben
    elhelyezhetők formázó utasítások (% jellel kezdve), amelyek egy
    adat megfelelő formátumban való kiírását eredményezik. Az adatokat
    az R1..R12 regiszterekben adhatjuk át, amelyekből sorban annyit
    használ fel a szubrutin, amennyi formázó utasítás van a
    szövegben.</p>

    <p>A szubrutin által kezelt formázó utasítások a következők:</p>

    <table border=1>
      <tr><th>Utasítás</th> <th>Formátum</th> <th>Példa, megjegyzés</th></tr>
      <tr><td>%%</td> <td>Százalékjel</td> <td>%</td></tr>
      <tr><td>%u</td> <td>Előjel nélküli decimális</td> <td>12345</td></tr>
      <tr><td>%d</td> <td>Előjeles decimális</td> <td>-12345</td></tr>
      <tr><td>%x</td> <td>32 bites hexadecimális</td> <td>1a2b3c5d</td></tr>
      <tr><td>%b</td> <td>32 bites bináris</td> <td>00010010001101000101011001111000</td></tr>
      <tr><td>%p</td> <td>32 bites pointer</td> <td>02AB_CD78</td></tr>
      <tr><td>%s</td> <td>Szöveg</td> <td>az adat regiszternek a
      beillesztendő (normál, vagy pakolt) szöveg címét kell
      tartalmaznia</td></tr>
      <tr><td>%c</td> <td>Karakter</td> <td>az adat regiszterben lévő
      ASCII kódot írja ki</td></tr>
    </table>

    <p>A % jel és a formázó utasítás között lehetnek paraméterek,
      amelyek befolyásolhatják a kiírás jellemzőit.</p>

    
    <a name="printf_width"><h4><b>szám</b> width, mező szélesség</h4></a>
    
    <p>A paraméternek 0-tól eltérő számjeggyel kezdődő decimális
    számnak kell lennie. A formázó utasítás által kiírt szöveg által
    elfoglalt karakterhelyek számát adja meg. A %d, %u esetén a szám
    akkor is kiíródik, ha ennél hosszabb. %x, %b esetén a hosszabb
    szövegek balról csonkolódnak, tehát csak a megadott számú alsó
    helyiértékek karakterei íródnak ki.</p>

    <samp>
%d       "10000"
%15d     "          10000"
%u       "4294967196"
%5u      "4294967196"
%15u     "     4294967196"
%x       "3e8"
%5x      "003e8"
%15x     "            3e8"
%2x      "e8"
%b       "00010010001101000101011001111000"
%34b     "  00010010001101000101011001111000"
%9b      "001111000"
    </samp>

    
    <a name="printf_left"><h4><b>-</b> left, balra igazítás</h4></a>
    
    <p>Akkor van hatása, ha megadjuk a kiíráshoz a mező szélességet,
      és a szélesség nagyobb, mint a behelyettesített szöveg
      hossza. Ebben az esetben a kiírás a mező bal széléhez lesz
      igazítva, a jobb szél helyett.</p>
      
    <samp>
%20s   "         HelloWorld!"
%-20s  "HelloWorld!         "
%5u    "4294967196"
%15u   "     4294967196"
%-15u  "4294967196     "
%5d    "10000"
%15d   "          10000"
%-15d  "10000          "
%5x    "003e8"
%15x   "            3e8"
%-15x  "3e8            "
%5bb   "11000"
%34b   "  00010010001101000101011001111000"
%-34b  "00010010001101000101011001111000  "
  </samp>


    <a name="printf_sign"><h4><b>+</b> sign, előjel</h4></a>

    <p>Csak a %d formátum esetében van hatása. Ha megadjuk, akkor a
    pozitív számok előjele is kiíródik.</p>

    <samp>
%d       "10000"
%+d      "+10000"
%-+15d   "+10000         "
    </samp>


    <a name="printf_zero"><h4><b>0</b> zero, balról kitöltés 0-val</h4></a>

    <p>Szám típusú formátumok (%u, %d, %x, %b) esetén van hatása
    akkor, ha a szám előjele nem jelenik meg, meg van adva a mező
    szélesség és ez nagyobb mint a szöveg hossza. Ekkor a megadott
    mezőhossz balról 0 karakterekkel lesz feltöltve.</p>

    <samp>
%015u    "000004294967196"
%015d    "000000000010000"
%0+15d   "         +10000"
%015d    "          -1000"
%015x    "0000000000003e8"
%034b    "0000010010001101000101011001111000"
    </samp>
    
    
    <a name="eprintf"><h3>eprintf</h3></a>

    <ul>
      <li><span lang="en">Input(s): R1..R12 parameter values</span>
	<span lang="hu">Bemenet(ek): R1..R12 paraméter értékek</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
    </ul>

    <p>Beágyazott, 0 végződésű formázó szöveg kiírása a terminálra. A
    formázó szövegnek közvetlenül a CALL (vagy CES) utasítás után kell
    lennie, a további paraméterek a printf szubrutinéval egyeznek,
    azonban ez a funkció az R0 regiszterben nem vár bemenő adatot.</p>

    <p><b>A függvény módosítja az R0-R12 regiszterek, valamit a Flag
      regiszter értékét.</b></p>

    <samp>UART_CPB = 0xff44

        ld      r1,UART_CPB
        mov     r2,r1
        ces     eprintf
        db      ”Uart cpb= %d (0x%x)\n”
        nop
        ...
    </samp>


    <hr>
  </body>
</html>
