<!DOCTYPE html>
<html id="html-tag" lang="en">
  <script>
   const $htmlTag = document.querySelector("#html-tag")
   const urlParams = new URL(window.location.toLocaleString()).searchParams;
   const lvar= urlParams.get('lang');
   switch(lvar) {
     case "hu":
       $htmlTag.lang = "hu"
       $htmlTag.classList.add("hungarianLang")
       break
     default:
       $htmlTag.classList.add("englishLang")
       break
   }
  </script>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="p12.css">
    <title>p2223 function library</title>
  </head>
  
  <body>

    <span lang="hu">Lang:</span> <span lang="en">Nyelv:</span>
    <a href="lib.html?lang=hu">HU</a>
    <a href="lib.html?lang=en">EN</a>

    <h1>
      <psan lang="en">p2223 function library</psan>
      <span lang="hu">p2223 függvény könyvtár</span>
    </h1>

    <p>A fejlesztőrendszerben a projekt alkalmazásának lefordítása
    során a program kiegészül a rendszerben elérhető
    függvényekkel. Ezeken túl a pmon monitorprogram függvényei is
    hívhatók.</p>
      
    <h2>
      <span lang="en">Output functions</span>
      <span lang="hu">Kimeneti függvények</span>
    </h2>

    
    <h3>putchar</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 character</span>
	<span lang="hu">R0 karakter</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	-
      </li>
    </ul>
    
    <p>A bemenetként megadott karakterkód kiírása az UART periférián
    keresztül a terminálra. A függvény először megvárja az előzőleg
    kiírt karakter kiküldését.</p>


    <h3>prints</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 address of string</span>
	<span lang="hu">R0 sztring kezdőcíme</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	-
      </li>
    </ul>

    <p>Szöveg (0 végződésű karaktersorozat) kiírása a terminálra.</p>


    <h3>printsnl</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 address of string</span>
	<span lang="hu">R0 sztring kezdőcíme</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>Szöveg (0 végződésű karaktersorozat) kiírása a terminálra,
      ezután a függvény kiír egy soremelés karaktert.</p>

    
    <h3>printh</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 value;
	  <br>R1 nr of chars between separators (_)</span>
	<span lang="hu">R0 számérték;
	  <br>R1 az elválasztó (_) közötti karakterek száma</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>Kiírja a bemeneti 32 bites bináris egész szám értékét a
    terminálra hexadecimális számrendszerben, 8 karakteren, bevezető
    nullákkal. Az R1-ben megadott számú karakterenként egy _
    elválasztó jelet is kiír.</p>

    
    <h3>printd</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0 value</span>
	<span lang="hu">R0 érték</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>A bemenetként megadott 32 bites (pozitív) bináris számot kiírja
      a terminálra tízes számrendszerben.</p>

    
    <h3>eprints</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
	</li>
    </ul>

    <p>Beágyazott, 0 végződésű karaktertömb kiírása a terminálra. A
    sztringnek a program kódjában közvetlenül a szubrutint meghívó
    CALL utasítás után kell lennie. A szubrutin a sztring záró nullája
    utáni címre fog visszatérni. Escape szekvenciák (formázó
    karakterek) nem használhatók. A funkciónak sem bemeneti, sem
    kimeneti paraméterei nincsenek. Helyes használatára egy példa:</p>

    <samp>
        nop

        call    eprints
        db      ”Hello World!\n”
        mvzl    r0,12
        ...
    </samp>

    <p>A CALL utasítás helyett ebben az esetben használható a CES
      utasítás is.</p>
    
    
    <h3>printf</h3>

    <ul>
      <li><span lang="en">Input(s): R0 address of format string
	<br>R1..R12 parameter values</span>
	<span lang="hu">Bemenet(ek): R0 formázó szöveg címe
	<br>R1..R12 paraméterek értékei</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
    </ul>

    <p>Formázott szöveg kiírása a terminálra. A szövegben
    elhelyezhetők formázó utasítások (% jellel kezdve), amelyek egy
    adat megfelelő formátumban való kiírását eredményezik. Az adatokat
    az R1..R12 regiszterekben adhatjuk át, amelyekből sorban annyit
    használ fel a szubrutin, amennyi formázó utasítás van a
    szövegben.</p>

    <p><b>A függvény módosítja az R0-R12 regiszterek, valamit a Flag
      regiszter értékét.</b></p>

      <p>A formázó szövegben escape szekvenciákat is
    használhatunk:</p>

    <table border=1>
      <tr><th>Escape szekvencia</th> <th>Kiírt karakterkód</th></tr>
      <tr><td>\a</td> <td>7</td></tr>
      <tr><td>\b</td> <td>8</td></tr>
      <tr><td>\e</td> <td>31</td></tr>
      <tr><td>\f</td> <td>12</td></tr>
      <tr><td>\n</td> <td>10</td></tr>
      <tr><td>\r</td> <td>13</td></tr>
      <tr><td>\t</td> <td>9</td></tr>
      <tr><td>\v</td> <td>11</td></tr>
      <tr><td>\\</td> <td>'\'</td></tr>
      <tr><td>\0</td> <td>0</td></tr>
    </table>

    <p>A szubrutin által kezelt formázó utasítások a következők:</p>

    <table border=1>
      <tr><th>Utasítás</th> <th>Formátum</th> <th>Példa, megjegyzés</th></tr>
      <tr><td>%%</td> <td>Százalékjel</td> <td>%</td></tr>
      <tr><td>%u, %d</td> <td>Előjel nélküli decimális</td> <td>12345</td></tr>
      <tr><td>%x</td> <td>32 bites hexadecimális</td> <td>1A2B3C5D</td></tr>
      <tr><td>%s</td> <td>Szöveg</td> <td>az adat regiszternek a
      beillesztendő szöveg címét kell tartalmaznia</td></tr>
      <tr><td>%c</td> <td>Karakter</td> <td>az adat regiszterben lévő
      ASCII kódot írja ki</td></tr>
    </table>

    
    <h3>eprintf</h3>

    <ul>
      <li><span lang="en">Input(s): R1..R12 parameter values</span>
	<span lang="hu">Bemenet(ek): R1..R12 paraméter értékek</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
    </ul>

    <p>Beágyazott, 0 végződésű formázó szöveg kiírása a terminálra. A
    formázó szövegnek közvetlenül a CALL (vagy CES) utasítás után kell
    lennie, a további paraméterek a printf szubrutinéval egyeznek,
    azonban ez a funkció az R0 regiszterben nem vár bemenő adatot.</p>

    <p><b>A függvény módosítja az R0-R12 regiszterek, valamit a Flag
      regiszter értékét.</b></p>

    <samp>UART_CPB = 0xff44

        ld      r1,UART_CPB
        mov     r2,r1
        ces     eprintf
        db      ”Uart cpb= %d (0x%x)\n”
        nop
        ...
    </samp>

    <h2>
      <span lang="en">Input functions</span>
      <span lang="hu">Bemeneti függvények</span>
    </h2>


    <h3>input_avail</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">Flag.C=1 if input is available</span>
	<span lang="hu">Flag.C=1 ha van bemenő adat</span>
      </li>
    </ul>

    <p>Az UART vevő állapotának vizsgálata. Azt mutatja meg, hogy
    van-e az UART-ban beolvasható vett karakter, ha igen, a flag
    regiszter C bitje 1 lesz.</p>

    
    <h3>getchar</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">Flag.C=1, R0=received character</span>
	<span lang="hu">Flag.C=1, R0=beolvasott karakter</span>
      </li>
    </ul>

    <p>Várakozás egy karakter vételére, majd a karakter kiolvasása az
    UART áramkörből.</p>

    
    <h3>read</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">R0=received character</span>
	<span lang="hu">R0=vett karakater</span>
      </li>
    </ul>

    <p>Az UART vevő áramkörének kiolvasása. A szubrutin nem vár új
    karakterre, a vevő állapotát előzőleg az input_avail funkcióval
    kell vizsgálni.</p>


    <h3>le_init</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0=buffer address, R1=buffer length</span>
	<span lang="hu">R0=puffer címe, R1=puffer hossza</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
    </ul>

    <p>A sor beolvasó függvény számára beállítja a beolvasáshoz
    használandó puffer címét és méretét. A puffert üresre állítja, így
    a sor beolvasása elkezdhető.</p>


    <h3>le_start</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
    </ul>

    <p>A sor beolvasó függvény által használt puffert kiüríti, így új
    beolvasás kezdhető.</p>


    <h3>le_read</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">-</span>
	<span lang="hu">-</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">Flag.C=1 if line read is ready (ENTER pressed)</span>
	<span lang="hu">Flag.C=1 ha a sor beolvasás kész (ENTER-t lenyomták)</span>
      </li>
    </ul>

    <p>Megvizsgálja, hogy van-e beolvasható karakter, ha igen,
    elhelyezi a sor pufferben, amíg az meg nem telik. Kezeli a
    backspace törlő billentyűt. Ha a bevitel közben megnyomták az
    ENTER-t, akkor a C flag-et 1-be állítja.</p>


    <h2>
      <span lang="en">Character functions</span>
      <span lang="hu">Karakter kezelő függvények</span>
    </h2>


    <h3>isdigit</h3>
    
    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en">R0=character</span>
	<span lang="hu">R0=karakter</span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en">Flag.C=1 if character is number</span>
	<span lang="hu">Flag.C=1 ha a karakter számjegy</span>
      </li>
    </ul>

    

    <h2>
      <span lang="en">String functions</span>
      <span lang="hu">Szövegkezelő függvények</span>
    </h2>


    <h3>dtoi</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>


    <h3>htoi</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <h3>strchr</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <h3>streq</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <h3>strieq</h3>
    
    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <h3>strlen</h3>
    
    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <h3>strsize</h3>
    
    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <h2>
      <span lang="en">Arithmetic functions</span>
      <span lang="hu">Aritmetikai függvények</span>
    </h2>


    <h3>div</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>


    <h3>rand</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>


    <h3>srand</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <h2>
      <span lang="en">Board specific functions</span>
      <span lang="hu">Kártya kezelő függvények</span>
    </h2>


    <h3>pressed</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>


    <h3>switched</h3>
    
    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>


    <h3>restart_button</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>


    <h3>restart_switch</h3>

    <ul>
      <li><span lang="en">Input(s):</span>
	<span lang="hu">Bemenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
      <li><span lang="en">Output(s):</span>
	<span lang="hu">Kimenet(ek):</span>
	<span lang="en"></span>
	<span lang="hu"></span>
      </li>
    </ul>

    
    <hr>
  </body>
</html>
